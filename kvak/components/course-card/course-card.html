{% load static wagtailimages_tags kvak_extras %}

{% get_user_progress course_page as user_progress %}
<a href="{% if user.is_anonymous %}{% url 'register' %}{% else %}{{ href }}{% endif %}" class="course-card-component {% if user_progress and user_progress.finished == user_progress.total %}th-purple{% endif %} {% if show_continue %}small-bottom-padding{% endif %}">
  {% if user_progress and user_progress.finished == user_progress.total %}
  <div class="badge-overlay">
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 101 101">
      <path fill="#6258b9" stroke="#000" d="M50.2002.5c4.8153 0 8.7552 2.724 11.2832 7.5996 4.6206-2.96 9.3947-3.3485 13.5664-.9404 4.1714 2.4079 6.2215 6.7357 5.9707 12.2187 5.4806-.2597 9.814 1.8026 12.2207 5.9727 2.407 4.1707 2.0183 8.9448-.9375 13.5654 4.8723 2.5281 7.5957 6.4685 7.5957 11.2842 0 4.8156-2.7246 8.7552-7.6006 11.2832 2.9603 4.6207 3.3496 9.3946.9414 13.5664-2.4079 4.1715-6.7406 6.2259-12.2207 5.9707.2511 5.484-1.7997 9.8135-5.9707 12.2207-4.1706 2.407-8.9451 2.0229-13.5664-.9375-2.5281 4.872-6.4676 7.5957-11.2832 7.5957-4.816 0-8.7562-2.7248-11.2842-7.6015-4.6206 2.9601-9.3935 3.3505-13.5654.9423s-6.223-6.7367-5.9717-12.2207c-5.4792.2507-9.8126-1.8-12.2197-5.9707s-2.0194-8.9456.9365-13.5664C3.2232 58.9543.5 55.0145.5 50.1992c0-4.8157 2.7243-8.7561 7.6006-11.2842-2.9599-4.6205-3.3494-9.3937-.9414-13.5654 2.408-4.1715 6.7232-6.2271 12.2197-5.9717-.2508-5.4835 1.801-9.8126 5.9717-12.2197s8.9449-2.019 13.5654.9365C41.4441 3.223 45.3848.5 50.2002.5Z"/>
    </svg>
  </div>
  {% endif %}
  <div class="image">
    {% if image %}
    {% image image fill-720x405 %}
    {% else %}
    <img src="{% static 'img/image-placeholder.png' %}" alt="">
    {% endif %}
  </div>
  <{{ heading }} class="title">{{ title }}</{{ heading }}>
  <div class="description rich-text">
    {{ description }}
  </div>
  {% if user.is_anonymous %}
  {% component "arrow-button" type="inert" text="REGISTER" / %}
  {% else %}
    {% if user_progress and user_progress.finished == user_progress.total %}
    <div class="badge-collected">BADGE COLLECTED!</div>
      {% if not show_continue %}
      <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 30 30" class="course-card__icon">
        <circle cx="15" cy="15" r="15" fill="var(--th-color-lighter)" />
        <path
          fill="#000"
          d="M20.671 20.73c-.24.241-.616.234-1.37.221-1.27-.022-3.043-.072-4.382-.178a62.903 62.903 0 0 1-3.036-.338c-1.293-.17-1.94-.255-2.104-.715-.164-.46.284-.938 1.183-1.894.366-.39.759-.805 1.159-1.226a54.033 54.033 0 0 1-1.818-1.712 61.954 61.954 0 0 1-2.125-2.277c-.467-.522-.701-.783-.692-1.101.009-.319.259-.569.76-1.07l1.994-1.994c.5-.5.75-.75 1.069-.76.318-.008.58.226 1.1.693a61.94 61.94 0 0 1 2.278 2.125 53.867 53.867 0 0 1 1.708 1.814c.47-.447.937-.89 1.371-1.297.956-.898 1.433-1.347 1.894-1.182.46.164.545.81.716 2.103.133 1.014.265 2.123.337 3.037.107 1.338.156 3.112.179 4.382.012.753.02 1.13-.22 1.37Z"
        />
      </svg>
      {% endif %}
    {% elif show_continue %}
    {% component "arrow-button" type="inert" text="CONTINUE" / %}
    {% else %}
    <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 30 30" class="course-card__icon">
      <circle cx="15" cy="15" r="15" fill="var(--th-color-lighter)" />
      <path
        fill="#000"
        d="M20.671 20.73c-.24.241-.616.234-1.37.221-1.27-.022-3.043-.072-4.382-.178a62.903 62.903 0 0 1-3.036-.338c-1.293-.17-1.94-.255-2.104-.715-.164-.46.284-.938 1.183-1.894.366-.39.759-.805 1.159-1.226a54.033 54.033 0 0 1-1.818-1.712 61.954 61.954 0 0 1-2.125-2.277c-.467-.522-.701-.783-.692-1.101.009-.319.259-.569.76-1.07l1.994-1.994c.5-.5.75-.75 1.069-.76.318-.008.58.226 1.1.693a61.94 61.94 0 0 1 2.278 2.125 53.867 53.867 0 0 1 1.708 1.814c.47-.447.937-.89 1.371-1.297.956-.898 1.433-1.347 1.894-1.182.46.164.545.81.716 2.103.133 1.014.265 2.123.337 3.037.107 1.338.156 3.112.179 4.382.012.753.02 1.13-.22 1.37Z"
      />
    </svg>
    {% endif %}
  {% endif %}
</a>
